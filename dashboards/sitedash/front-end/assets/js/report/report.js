var reportChart;
$(document).ready(function() {
	var checked = false;
	function mySwitch(x) {
		checked = x;
		if (checked) {
			$("#switch-sim").addClass("black-text");
			$("#switch-his").removeClass("black-text");
			// $("#zone-chart").hide();
			// $("#bldng-chart").show();
			// $("#zone-config").hide();
			// $("#bldng-config").show();
		} else {
			$("#switch-his").addClass("black-text");
			$("#switch-sim").removeClass("black-text");
			// $("#bldng-chart").hide();
			// $("#zone-chart").show();
			// $("#bldng-config").hide();
			// $("#zone-config").show();
		}
		checked = !checked;
		$("#rep-checkbox").prop("checked", checked);
	}

	$("#rep-switch").click(function(event) { event.stopImmediatePropagation(); $("#checkbox").prop("checked", checked); });
	$("#rep-label").click(function(event) { event.stopImmediatePropagation(); $("#checkbox").prop("checked", checked); });
	$("#rep-checkbox").click(function(event) { event.stopImmediatePropagation(); $("#checkbox").prop("checked", checked); });

	function unbind() { $("#switch-bldng").unbind(); $("#switch-zone").unbind(); $("#lever").unbind(); }

	function setTextColor(x, a, b) {
		if (x) { a.addClass("black-text"); b.removeClass("black-text"); }
		else { a.removeClass("black-text"); b.addClass("black-text"); }
	}
	
	function enableBZSwitch() {
		unbind();
		$("#switch-sim").click(function(event) { event.stopImmediatePropagation(); mySwitch(false); });
		$("#switch-his").click(function(event) { event.stopImmediatePropagation(); mySwitch(true); });
		$("#rep-lever").click(function(event) { event.stopImmediatePropagation(); mySwitch(checked); });
		$("#rep-checkbox").prop("disabled", "");
		setTextColor(checked, $("#switch-his"), $("#switch-sim"));
		$("#switch-sim").css("cursor", "pointer");
		$("#switch-his").css("cursor", "pointer");
	} enableBZSwitch();

	function pointFormatter() {
		return "<span style='font-size: 14px;'>hi<br/>";
    }

    function processResp(d) {
    	
    }

	var options = {
		"chart": {
			"resetZoomButton": {
				"theme": {
					"display": "none"
				}
			},
			"zoomType": "x",
			"scrollablePlotArea": {
				"minWidth": 450
			},
			"renderTo": "report-chart",
			"events": {
				"load": function(e) {
					$.ajax({
						"url": "http://127.0.0.1:5000/api/hvac/day/30m",
						"type": "GET",
						"dataType": "json",
						"success": function(d) { console.log("copy error here"); },
						"error": function(d) {
							var d = {"site": "avenal-animal-shelter", "date": "07-19-2018", "cost": { "actual": 17.23, "baseline:": 57.80 }, "baseline-type": "Linear Regression", "degree-days": { "cooling": 5, "heating": 0 }, "actual": { "1531987200000000000": 8288.0, "1531988100000000000": 6176.0, "1531989000000000000": 7552.0, "1531989900000000000": 4640.0, "1531990800000000000": 6432.0, "1531991700000000000": 5824.0, "1531992600000000000": 5024.0, "1531993500000000000": 6752.0, "1531994400000000000": 3744.0, "1531995300000000000": 6592.0, "1531996200000000000": 4320.0, "1531997100000000000": 5920.0, "1531998000000000000": 4704.0, "1531998900000000000": 5248.0, "1531999800000000000": 4736.0, "1532000700000000000": 5056.0, "1532001600000000000": 4608.0, "1532002500000000000": 5280.0, "1532003400000000000": 3936.0, "1532004300000000000": 6112.0, "1532005200000000000": 3808.0, "1532006100000000000": 5984.0, "1532007000000000000": 3712.0, "1532007900000000000": 4544.0, "1532008800000000000": 4224.0, "1532009700000000000": 4160.0, "1532010600000000000": 5792.0, "1532011500000000000": 7072.0, "1532012400000000000": 9856.0, "1532013300000000000": 7232.0, "1532014200000000000": 9664.0, "1532015100000000000": 11744.0, "1532016000000000000": 7968.0, "1532016900000000000": 11168.0, "1532017800000000000": 10272.0, "1532018700000000000": 10048.0, "1532019600000000000": 11296.0, "1532020500000000000": 11328.0, "1532021400000000000": 11776.0, "1532022300000000000": 11648.0, "1532023200000000000": 10976.0, "1532024100000000000": 11680.0, "1532025000000000000": 10688.0, "1532025900000000000": 10880.0, "1532026800000000000": 10880.0, "1532027700000000000": 11168.0, "1532028600000000000": 10752.0, "1532029500000000000": 10880.0, "1532030400000000000": 11072.0, "1532031300000000000": 11616.0, "1532032200000000000": 11648.0, "1532033100000000000": 11424.0, "1532034000000000000": 11520.0, "1532034900000000000": 10240.0, "1532035800000000000": 9824.0, "1532036700000000000": 9824.0, "1532037600000000000": 9888.0, "1532038500000000000": 9792.0, "1532039400000000000": 9024.0, "1532040300000000000": 7968.0, "1532041200000000000": 2752.0, "1532042100000000000": 2208.0, "1532043000000000000": 2336.0, "1532043900000000000": 2144.0, "1532044800000000000": 2176.0, "1532045700000000000": 2112.0, "1532046600000000000": 3040.0, "1532047500000000000": 3040.0, "1532048400000000000": 3200.0, "1532049300000000000": 3040.0, "1532050200000000000": 3104.0, "1532051100000000000": 3104.0, "1532052000000000000": 3104.0, "1532052900000000000": 3040.0, "1532053800000000000": 3168.0, "1532054700000000000": 3072.0, "1532055600000000000": 3072.0, "1532056500000000000": 3264.0, "1532057400000000000": 3488.0, "1532058300000000000": 3552.0, "1532059200000000000": 3520.0, "1532060100000000000": 3648.0, "1532061000000000000": 3520.0, "1532061900000000000": 3584.0, "1532062800000000000": 3552.0, "1532063700000000000": 3616.0, "1532064600000000000": 3776.0, "1532065500000000000": 3872.0, "1532066400000000000": 3680.0, "1532067300000000000": 3712.0, "1532068200000000000": 3776.0, "1532069100000000000": 3712.0, "1532070000000000000": 7456.0, "1532070900000000000": 7296.0, "1532071800000000000": 8224.0, "1532072700000000000": 7328.0}, "baseline": { "1531987200000000000": 6112.2582947533, "1531988100000000000": 5886.2757730824, "1531989000000000000": 5905.797098581, "1531989900000000000": 5830.4922073292, "1531990800000000000": 5870.6539607671, "1531991700000000000": 5965.522790993, "1531992600000000000": 6082.5210828037, "1531993500000000000": 5873.018816445, "1531994400000000000": 5883.9235392837, "1531995300000000000": 6049.6622700668, "1531996200000000000": 5879.8955545917, "1531997100000000000": 5976.2121517736, "1531998000000000000": 5953.7940794453, "1531998900000000000": 6128.3600258063, "1531999800000000000": 6187.1117425467, "1532000700000000000": 6142.9308679995, "1532001600000000000": 6137.6109532295, "1532002500000000000": 6250.5110730454, "1532003400000000000": 6195.5910716133, "1532004300000000000": 6171.1596047953, "1532005200000000000": 6147.7921226955, "1532006100000000000": 6171.1235838498, "1532007000000000000": 6349.1486299907, "1532007900000000000": 6855.5766550708, "1532008800000000000": 6742.4515722136, "1532009700000000000": 7668.4337130427, "1532010600000000000": 7956.2314959764, "1532011500000000000": 7033.5119757067, "1532012400000000000": 7189.2079608189, "1532013300000000000": 7415.0021332475, "1532014200000000000": 7325.4107766511, "1532015100000000000": 7437.6683187248, "1532016000000000000": 6815.0152832476, "1532016900000000000": 7614.7597387976, "1532017800000000000": 7343.5747732898, "1532018700000000000": 7291.9484131168, "1532019600000000000": 7294.2066667962, "1532020500000000000": 8074.8520852154, "1532021400000000000": 8256.8172548345, "1532022300000000000": 8214.6241697188, "1532023200000000000": 8390.7825812724, "1532024100000000000": 8426.8276361719, "1532025000000000000": 8569.7626683791, "1532025900000000000": 8935.9238803159, "1532026800000000000": 8864.4201954005, "1532027700000000000": 8834.6091384007, "1532028600000000000": 8964.2128827066, "1532029500000000000": 9106.1186135505, "1532030400000000000": 8365.1896562182, "1532031300000000000": 9234.6192920215, "1532032200000000000": 9629.2101665116, "1532033100000000000": 9790.4228519642, "1532034000000000000": 9711.0532467391, "1532034900000000000": 11093.0072920412, "1532035800000000000": 9977.5529900508, "1532036700000000000": 10158.3761171804, "1532037600000000000": 9152.3579343971, "1532038500000000000": 9368.644978239, "1532039400000000000": 9350.6024434603, "1532040300000000000": 8250.0825350084, "1532041200000000000": 6727.8125933579, "1532042100000000000": 6765.7107693642, "1532043000000000000": 6398.7204143929, "1532043900000000000": 6332.7749423576, "1532044800000000000": 6426.8331791861, "1532045700000000000": 6320.39927059, "1532046600000000000": 6851.3380024049, "1532047500000000000": 6862.9610282626, "1532048400000000000": 6854.6750809061, "1532049300000000000": 7090.7625882138, "1532050200000000000": 7059.9024721466, "1532051100000000000": 7027.8507982798, "1532052000000000000": 7149.7262656498, "1532052900000000000": 7049.6946829567, "1532053800000000000": 7021.1783507146, "1532054700000000000": 7109.1216127991, "1532055600000000000": 6935.1382690738, "1532056500000000000": 6923.8815037056, "1532057400000000000": 6808.6239442723, "1532058300000000000": 6926.7680833175, "1532059200000000000": 6911.213728841, "1532060100000000000": 6794.9384439198, "1532061000000000000": 6838.7548352, "1532061900000000000": 6831.0412213237, "1532062800000000000": 7243.6396362357, "1532063700000000000": 7146.5221386009, "1532064600000000000": 7583.0896361193, "1532065500000000000": 7571.2847804977, "1532066400000000000": 7158.5097189514, "1532067300000000000": 7128.9881057194, "1532068200000000000": 7048.0634822738, "1532069100000000000": 7017.9355528776, "1532070000000000000": 7190.8282144389, "1532070900000000000": 7506.0903381235, "1532071800000000000": 7407.8510265452, "1532072700000000000": 6986.4318754599}};
							console.log(d);
							var a = processResp(d);

							for (var x = 0; x < a.length; x += 1) { reportChart.addSeries(a[x], false); }
							$("#bldng-reset").addClass("scale-in");
							reportChart.hideLoading();
							reportChart.redraw();
						}
					});
				}
			}
		},
		"title": {
			"text": "Baseline (Building)"
		},
		"loading": {
			"hideDuration": 0,
			"showDuration": 0,
			"style": {
				"opacity": .75
			}
		},
		"xAxis": [
			{
				"id": "myXAxis",
				"type": "category",
				"plotBands": {
					"color": "#F7B4B6",
					"from": 14,
					"to": 18
				}
			}
		],
		"yAxis": [
			{
				"title": { "text": "°F" },
				"height": 225
			},
			{
				"height": 60,
				"top": 300,
				"visible": false
			}
		],
		"credits": {
			"enabled": false
		},
		"legend": {
			"enabled": false
		},
		"plotOptions": {
			"line": {
				"marker": {
					"enabled": false,
				}
			},
			"series": {
				"stickyTracking": true,
				"states": {
					"hover": {
						"enabled": false
					}
				},
				"events": {
					// "legendItemClick": function () {
						// var s = this.chart.series;
						// for (var i = 0; i < s.length; i += 1) {
							// s[i].hide();
						// }
						// reportChart.setTitle(null, { text: "Zone: " + this.name} );
						// return true;
					// }
				}
			}
		},
		"tooltip": {
			"headerFormat": '<span style="font-size:14px">{point.key}</span><br/>',
			"pointFormatter": pointFormatter,
			"hideDelay": 500,
			"shared": true,
			"crosshairs": true,
			"padding": 6
		},
		"series": []
	};
	reportChart = new Highcharts.Chart(options);
});
